---
interface Props {
  currentLang: 'es' | 'en';
  alternativeUrls?: {
    es?: string;
    en?: string;
  };
}

const { currentLang, alternativeUrls } = Astro.props;

const currentPath = Astro.url.pathname;
const pathWithoutLang = currentPath.replace(/^\/en/, '') || '/';

let esUrl: string;
let enUrl: string;

if (alternativeUrls) {
  esUrl = alternativeUrls.es ?? '/';
  enUrl = alternativeUrls.en ?? '/en/';
} else {
  const isBlogPost = pathWithoutLang.match(/^\/blog\/.+/);
  
  if (isBlogPost && currentLang === 'en') {
    esUrl = '/blog/';
    enUrl = currentPath;
  } else if (isBlogPost && currentLang === 'es') {
    esUrl = currentPath;
    enUrl = '/en/blog/';
  } else {
    esUrl = pathWithoutLang;
    enUrl = `/en${pathWithoutLang === '/' ? '' : pathWithoutLang}`;
  }
}
---

<div class="language-switcher animate-in delay-1">
  <div class="flex items-center gap-0.5 text-xs font-medium tracking-wide">
    <a 
      href={esUrl} 
      class={`lang-link ${currentLang === 'es' ? 'active' : ''}`}
      aria-label="Cambiar a espaÃ±ol"
    >
      ES
    </a>
    <span class="divider"></span>
    <a 
      href={enUrl} 
      class={`lang-link ${currentLang === 'en' ? 'active' : ''}`}
      aria-label="Switch to English"
    >
      EN
    </a>
  </div>
</div>

<style>
  .language-switcher {
    display: inline-flex;
    align-items: center;
    padding: 6px 10px;
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid #18181b;
    border-radius: 6px;
    backdrop-filter: blur(8px);
  }

  .divider {
    width: 1px;
    height: 12px;
    background: #27272a;
    margin: 0 8px;
  }

  .lang-link {
    color: #52525b;
    text-decoration: none;
    padding: 2px 6px;
    transition: all 0.2s ease;
    border-radius: 4px;
  }

  .lang-link:hover {
    color: #a1a1aa;
    background: rgba(255, 255, 255, 0.05);
  }

  .lang-link.active {
    color: #f5a623;
    background: rgba(245, 166, 35, 0.1);
  }

  .lang-link.active:hover {
    color: #f5a623;
  }
</style>
